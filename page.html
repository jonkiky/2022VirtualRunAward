<!doctype html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <title></title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link href="css/bootstrap.css" rel="stylesheet" type="text/css" media="all" />
        <link href="css/stack-interface.css" rel="stylesheet" type="text/css" media="all" />
        <link href="css/theme.css" rel="stylesheet" type="text/css" media="all" />
        <link href="css/custom.css" rel="stylesheet" type="text/css" media="all" />
        <link href="https://fonts.googleapis.com/css?family=Open+Sans:200,300,400,400i,500,600,700" rel="stylesheet">

           <style type="text/css">
           .background-image{
            background-image:
    linear-gradient(to bottom, rgba(245, 246, 252, 0.52), rgba(117, 19, 93, 0.73)),
    url('img/pietro-rampazzo-x5GcXFvJJhI-unsplash.jpg');
            background-attachment: fixed;
            width: 100%;
            height: 100%;
            background-size: cover;

           }
           .award{
            padding: 10px;
           }

           .nft_header {
                color: white;
    font-weight: bolder;
    text-align: center;
        padding-top: 50px;
           }
           .award1{
            color: white;
    font-weight: bold;
    font-size: 2vh;
           }

           .award-pic{
            position: relative;
    max-width: 500px;
    margin: auto;
           }

           #award1-xiaoyou{
            top: 45%;
    position: absolute;
    left: 24%;
           }

           #award1-bianhao{
             top: 45%;
    position: absolute;
    left: 47%;
           }


           #award1-name{
                top: 45%;
    position: absolute;
    left: 66%;
           }

            #award-ry-bianhao{
             top: 35%;
    position: absolute;
    left: 47%;
           }


           #award-ry-name{
                top: 57%;
    position: absolute;
    left: 66%;
           }

           #award1-rank{
                position: absolute;
    left: 55%;
    top: 63%;
    font-size: 3vh;
           }


            #award-nlc-rank{
                 position: absolute;
    left: 59%;
    top: 63%;
    font-size: 3vh;

           }

              #award-nvlc-rank{
                 position: absolute;
    left: 61%;
    top: 63%;
    font-size: 3vh;

           }


              #award-npc-rank{
                 position: absolute;
    left: 61%;
    top: 63%;
    font-size: 3vh;

           }

            #award-rt-rank{
                 position: absolute;
    left: 55%;
    top: 63%;
    font-size: 3vh;

           }


       
    </style>

            
           

    </head>
 
    <body data-smooth-scroll-offset="77">
        <div class="main-container  background-image">
                <div class="container">
                      <div class="row" style="padding-top: 200px;">
                          <div class="col-md-1"></div>
                        <div class="col-md-10" style=" text-align: center;"> 
                         <div class="row">
                        <div class="col-md-12"> 
                                      <a id="btn-home" class="btn btn--primary type--uppercase" href="index.html"> <span class="btn__text">Home</span> </a>
                                </div>
                        </div>
                    <div id="award">
                      </div>
                       <div class="col-md-1"></div>
                    </div>
                </div>
                <div class="container">
                      <div class="row">
                        <div class="col-md-1"> </div>
                        <div class="col-md-10">
                            
                        </div>
                        <div class="col-md-1" style="
                            padding-bottom: 500px;
                        "> </div>
                      </div>
                </div>
             </div>
        </div>

        <script src="js/jquery-3.1.1.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.3.4/jspdf.debug.js"></script>
        <script src="js/parallax.js"></script>
        <script src="js/granim.min.js"></script>
        <script src="js/countdown.min.js"></script>
        <script src="js/smooth-scroll.min.js"></script>
        <script src="js/scripts.js"></script>
        <script type="text/javascript">


const queryString = window.location.search;
const urlParams = new URLSearchParams(queryString);
const email = urlParams.get('email')
console.log(email);

// check if email is not given
if(email == null){
  window.location.href = "index.html";
}
const dataAPI = "https://raw.githubusercontent.com/jonkiky/2022virtualRunData/main/data.json"

// reads awards info from API

$.getJSON( dataAPI, function( data ) {
  console.log(data);
  // finds awards associated with given email. 
  var awards = []
  for (var i = data.length - 1; i >= 0; i--) {
    if(email == data[i].email){
      awards.push(data[i])
    }
  }

  console.log(awards);
  var html = ""
  // construct html
  for (var i = awards.length - 1; i >= 0; i--) {

    // 少年组
    if(awards[i].award == "sn"){
       html = html.concat(" <div class=\"row\">"
+"                        <div class=\"col-md-12 award award1\"> "
+"                                    <div class=\"award-pic\"> "
+"                                        <a href=\"#\"> <img alt=\"Image\" src=\"template/1.png\"> </a>"
+"                                        <div > "
+"                                        <div id=\"award1-xiaoyou\" class=\"award1\">"+awards[i].school+"</div>"
+"                                        <div id=\"award1-bianhao\" class=\"award1\">"+awards[i].number+"</div>"
+"                                        <div id=\"award1-name\" class=\"award1\">"+awards[i].name+"</div>"
+"                                    </div>"
+"                                    </div>"
+"                                    "
+"                         </div>"
+"                    </div>") 

    }


    // 夫妻
    if(awards[i].award == "fq"){
       html = html.concat(" <div class=\"row\">"
+"                        <div class=\"col-md-12 award award1\"> "
+"                                    <div class=\"award-pic\"> "
+"                                        <a href=\"#\"> <img alt=\"Image\" src=\"template/9.png\"> </a>"
+"                                        <div > "
+"                                        <div id=\"award1-xiaoyou\" class=\"award1\">"+awards[i].school+"</div>"
+"                                        <div id=\"award1-bianhao\" class=\"award1\">"+awards[i].number+"</div>"
+"                                        <div id=\"award1-name\" class=\"award1\">"+awards[i].name+"</div>"
+"                                    </div>"
+"                                    </div>"
+"                                    "
+"                         </div>"
+"                    </div>") 

    }

 // 儿童
    if(awards[i].award == "rt"){
       html = html.concat(" <div class=\"row\">"
+"                        <div class=\"col-md-12 award award1\"> "
+"                                    <div class=\"award-pic\"> "
+"                                        <a href=\"#\"> <img alt=\"Image\" src=\"template/7.png\"> </a>"
+"                                        <div > "
+"                                        <div id=\"award1-xiaoyou\" class=\"award1\">"+awards[i].school+"</div>"
+"                                        <div id=\"award1-bianhao\" class=\"award1\">"+awards[i].number+"</div>"
+"                                        <div id=\"award1-name\" class=\"award1\">"+awards[i].name+"</div>"
+"                                        <div id=\"award-rt-rank\" class=\"award1\">"+awards[i].rank+"</div>"

+"                                    </div>"
+"                                    </div>"
+"                                    "
+"                         </div>"
+"                    </div>") 

    }


 // 荣誉奖  奖状tbd
    if(awards[i].award == "ryj"){
       html = html.concat(" <div class=\"row\">"
+"                        <div class=\"col-md-12 award award1\"> "
+"                                    <div class=\"award-pic\"> "
+"                                        <a href=\"#\"> <img alt=\"Image\" src=\"template/7.png\"> </a>"
+"                                        <div > "
+"                                        <div id=\"award-ry-bianhao\" class=\"award1\">"+awards[i].number+"</div>"
+"                                        <div id=\"award-ry-name\" class=\"award1\">"+awards[i].name+"</div>"

+"                                    </div>"
+"                                    </div>"
+"                                    "
+"                         </div>"
+"                    </div>") 

    }


 // 女子配速  
    if(awards[i].award == "nvpeisu"){
       html = html.concat(" <div class=\"row\">"
+"                        <div class=\"col-md-12 award award1\"> "
+"                                    <div class=\"award-pic\"> "
+"                                        <a href=\"#\"> <img alt=\"Image\" src=\"template/3.png\"> </a>"
+"                                        <div > "
+"                                        <div id=\"award1-xiaoyou\" class=\"award1\">"+awards[i].school+"</div>"
+"                                        <div id=\"award1-bianhao\" class=\"award1\">"+awards[i].number+"</div>"
+"                                        <div id=\"award1-name\" class=\"award1\">"+awards[i].name+"</div>"
+"                                        <div id=\"award-npc-rank\" class=\"award1\">"+awards[i].rank+"</div>"

+"                                    </div>"
+"                                    </div>"
+"                                    "
+"                         </div>"
+"                    </div>") 

    }

   
   // 男子配速  
    if(awards[i].award == "nanpeisu"){
       html = html.concat(" <div class=\"row\">"
+"                        <div class=\"col-md-12 award award1\"> "
+"                                    <div class=\"award-pic\"> "
+"                                        <a href=\"#\"> <img alt=\"Image\" src=\"template/6.png\"> </a>"
+"                                        <div > "
+"                                        <div id=\"award1-xiaoyou\" class=\"award1\">"+awards[i].school+"</div>"
+"                                        <div id=\"award1-bianhao\" class=\"award1\">"+awards[i].number+"</div>"
+"                                        <div id=\"award1-name\" class=\"award1\">"+awards[i].name+"</div>"
+"                                        <div id=\"award-npc-rank\" class=\"award1\">"+awards[i].rank+"</div>"

+"                                    </div>"
+"                                    </div>"
+"                                    "
+"                         </div>"
+"                    </div>") 

    }


// 女子里程  
    if(awards[i].award == "nvlicheng"){
       html = html.concat(" <div class=\"row\">"
+"                        <div class=\"col-md-12 award award1\"> "
+"                                    <div class=\"award-pic\"> "
+"                                        <a href=\"#\"> <img alt=\"Image\" src=\"template/4.png\"> </a>"
+"                                        <div > "
+"                                        <div id=\"award1-xiaoyou\" class=\"award1\">"+awards[i].school+"</div>"
+"                                        <div id=\"award1-bianhao\" class=\"award1\">"+awards[i].number+"</div>"
+"                                        <div id=\"award1-name\" class=\"award1\">"+awards[i].name+"</div>"
+"                                        <div id=\"award-nvlc-rank\" class=\"award1\">"+awards[i].rank+"</div>"

+"                                    </div>"
+"                                    </div>"
+"                                    "
+"                         </div>"
+"                    </div>") 

    }


// 男子里程  
    if(awards[i].award == "nanlicheng"){
       html = html.concat(" <div class=\"row\">"
+"                        <div class=\"col-md-12 award award1\"> "
+"                                    <div class=\"award-pic\"> "
+"                                        <a href=\"#\"> <img alt=\"Image\" src=\"template/5.png\"> </a>"
+"                                        <div > "
+"                                        <div id=\"award1-xiaoyou\" class=\"award1\">"+awards[i].school+"</div>"
+"                                        <div id=\"award1-bianhao\" class=\"award1\">"+awards[i].number+"</div>"
+"                                        <div id=\"award1-name\" class=\"award1\">"+awards[i].name+"</div>"
+"                                        <div id=\"award-nlc-rank\" class=\"award1\">"+awards[i].rank+"</div>"

+"                                    </div>"
+"                                    </div>"
+"                                    "
+"                         </div>"
+"                    </div>") 

    }



 // 通勤
    if(awards[i].award == "tongqing"){
       html = html.concat(" <div class=\"row\">"
+"                        <div class=\"col-md-12 award award1\"> "
+"                                    <div class=\"award-pic\"> "
+"                                        <a href=\"#\"> <img alt=\"Image\" src=\"template/8.png\"> </a>"
+"                                        <div > "
+"                                        <div id=\"award1-bianhao\" class=\"award1\">"+awards[i].number+"</div>"

+"                                    </div>"
+"                                    </div>"
+"                                    "
+"                         </div>"
+"                    </div>") 

    }

  }


  html_no_award = " <div class=\"row\">"
+"                        <div class=\"col-md-12 nft_header\"> "
+"                                    <h2 class=\"nft_header\"> 没有发现您的奖品，请继续努力。如有疑问请联系节目组。</h2>  "
+"                         </div>"
+"                    </div>"

  if(html!=""){
    $("#award").html(html)
  }else{
    $("#award").html(html_no_award)
  }
  
});

/*
var doc = new jsPDF();
var specialElementHandlers = {
    '#editor': function (element, renderer) {
        return true;
    }
};


function pdfMap() {
{
 var element = $("#award"); // 这个dom元素是要导出pdf的div容器
 var w = element.width(); // 获得该容器的宽
 var h = element.height(); // 获得该容器的高
 var offsetTop = element.offset().top; // 获得该容器到文档顶部的距离
 var offsetLeft = element.offset().left; // 获得该容器到文档最左的距离
 var canvas = document.createElement("canvas");
 var abs = 0;
 var win_i = $(window).width(); // 获得当前可视窗口的宽度（不包含滚动条）
 var win_o = window.innerWidth; // 获得当前窗口的宽度（包含滚动条）
 if(win_o>win_i){
  abs = (win_o - win_i)/2; // 获得滚动条长度的一半
 }
 canvas.width = w * 2; // 将画布宽&&高放大两倍
 canvas.height = h * 2;
 var context = canvas.getContext("2d");
 context.scale(2, 2);
 context.translate(-offsetLeft-abs,-offsetTop); 
 // 这里默认横向没有滚动条的情况，因为offset.left(),有无滚动条的时候存在差值，因此  
 // translate的时候，要把这个差值去掉
 html2canvas(element).then(function(canvas) {
 var contentWidth = canvas.width;
 var contentHeight = canvas.height;
 //一页pdf显示html页面生成的canvas高度;
 var pageHeight = contentWidth / 592.28 * 841.89;
 //未生成pdf的html页面高度
 var leftHeight = contentHeight;
 //页面偏移
 var position = 0;
 //a4纸的尺寸[595.28,841.89]，html页面生成的canvas在pdf中图片的宽高
 var imgWidth = 595.28;
 var imgHeight = 592.28/contentWidth * contentHeight;
 
 var pageData = canvas.toDataURL('image/jpeg', 1.0);
 
 var pdf = new jsPDF('', 'pt', 'a4');
 
 //有两个高度需要区分，一个是html页面的实际高度，和生成pdf的页面高度(841.89)
 //当内容未超过pdf一页显示的范围，无需分页
 if (leftHeight < pageHeight) {
 pdf.addImage(pageData, 'JPEG', 0, 0, imgWidth, imgHeight);
 } else { // 分页
  while(leftHeight > 0) {
   pdf.addImage(pageData, 'JPEG', 0, position, imgWidth, imgHeight)
   leftHeight -= pageHeight;
   position -= 841.89;
   //避免添加空白页
   if(leftHeight > 0) {
    pdf.addPage();
   }
  }
 }
 pdf.save('award.pdf');  
 })
}
}


$('#btn-download').click(function () {
  pdfMap();
})

*/
        </script>
    </body>

</html>